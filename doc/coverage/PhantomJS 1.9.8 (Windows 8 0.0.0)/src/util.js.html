<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for ./src/util.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../prettify.css">
    <link rel="stylesheet" href="../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header medium">
    <h1>Code coverage report for <span class="entity">./src/util.js</span></h1>
    <h2>
        Statements: <span class="metric">73.21% <small>(41 / 56)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">67.39% <small>(31 / 46)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">75% <small>(6 / 8)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">72.55% <small>(37 / 51)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; <a href="index.html">./src/</a> &#187; util.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">4770</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4770</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">17</span>
<span class="cline-any cline-yes">17</span>
<span class="cline-any cline-yes">17</span>
<span class="cline-any cline-yes">17</span>
<span class="cline-any cline-yes">19</span>
<span class="cline-any cline-yes">19</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">460392</span>
<span class="cline-any cline-yes">230203</span>
<span class="cline-any cline-yes">230203</span>
<span class="cline-any cline-yes">230193</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">230189</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">230199</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">9</span>
<span class="cline-any cline-yes">9</span>
<span class="cline-any cline-yes">37</span>
<span class="cline-any cline-yes">37</span>
<span class="cline-any cline-yes">9</span>
<span class="cline-any cline-yes">28</span>
<span class="cline-any cline-yes">8</span>
<span class="cline-any cline-yes">20</span>
<span class="cline-any cline-yes">18</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
/**
 * The Utility Class that provides some useful methods used throughout the ODM
 * @constructor
 */
jsonOdm.Util = function () {
    // nothing yet
};
&nbsp;
&nbsp;
/** Checks the input parameter and returns true if it is an array
 *
 * @param {*} arrayObject
 * @return {boolean}
 */
jsonOdm.Util.prototype.isArray = function(arrayObject){
    <span class="missing-if-branch" title="if path not taken" >I</span>if(!Array.isArray) {
<span class="cstat-no" title="statement not covered" >        return Object.prototype.toString.call(arrayObject) === "[object Array]";</span>
    }
    return Array.isArray(arrayObject);
};
&nbsp;
/**
 * Checks the type of an object. valid type values are:
 * number, string, undefined, object, array and RegExp, ArrayBuffer, null, boolean plus all other [object *] types
 * @param {*} object The object to test against a type
 * @param {string|string[]} type All possible types that will result in a true
 * @return {boolean}
 */
jsonOdm.Util.prototype.is = function(object,type){
    type = (typeof type == "string") ? [type] : type;
    var objectType = Object.prototype.toString.call(object);
    objectType = objectType.substring(8,objectType.length-1).toLowerCase();
    for(var i = 0; i &lt; type.length; i++) {
        var lowerType = type[i].toLowerCase();
        if ("array" == lowerType &amp;&amp; this.isArray(object)) return true;
        // all object types, i.e. "[object ArrayBuffer]"
        if(lowerType == objectType) return true;
        // number string object
        if (typeof object == lowerType) return true;
    }
    return false;
};
&nbsp;
/** Get only the keys of an object
 * @method objectKeys
 * @memberof jsonOdm.Util.prototype
 * @param {Object} object The objects to get the keys from
 * @return {Array} An array of keys
 */
jsonOdm.Util.prototype.objectKeys = Object.keys || (<span class="fstat-no" title="function not covered" ><span class="branch-1 cbranch-no" title="branch not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >    var hasOwnProperty = Object.prototype.hasOwnProperty,</span>
        hasDontEnumBug = !({ toString: null }).propertyIsEnumerable('toString'),
        dontEnums = [
            'toString',
            'toLocaleString',
            'valueOf',
            'hasOwnProperty',
            'isPrototypeOf',
            'propertyIsEnumerable',
            'constructor'
        ],
        dontEnumsLength = dontEnums.length;
&nbsp;
<span class="cstat-no" title="statement not covered" >    return <span class="fstat-no" title="function not covered" >function(obj) {</span></span>
<span class="cstat-no" title="statement not covered" >        if (typeof obj !== 'object' &amp;&amp; (typeof obj !== 'function' || obj === null)) {</span>
<span class="cstat-no" title="statement not covered" >            throw new TypeError('Object.keys called on non-object');</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        var result = [], prop, i;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (prop in obj) {</span>
<span class="cstat-no" title="statement not covered" >            if (hasOwnProperty.call(obj, prop)) {</span>
<span class="cstat-no" title="statement not covered" >                result.push(prop);</span>
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (hasDontEnumBug) {</span>
<span class="cstat-no" title="statement not covered" >            for (i = 0; i &lt; dontEnumsLength; i++) {</span>
<span class="cstat-no" title="statement not covered" >                if (hasOwnProperty.call(obj, dontEnums[i])) {</span>
<span class="cstat-no" title="statement not covered" >                    result.push(dontEnums[i]);</span>
                }
            }
        }
<span class="cstat-no" title="statement not covered" >        return result;</span>
    };
}());
&nbsp;
/** Query an object with a function
 *
 * @param {Object|Array} object
 * @param {...String} path
 * @return {*}
 */
jsonOdm.Util.prototype.branch = function(object,path){
    function goDown() {
        if(arguments &amp;&amp; arguments.length &amp;&amp; this){
            var subCollection = this[arguments[0]];
            if(!subCollection) return subCollection;
            return goDown.apply(subCollection,Array.prototype.slice.call( arguments, 1 ));
        }
        return this
    }
    return goDown.apply(object,path);
};
&nbsp;
/**
 * Projects an element to a projectionDefinition
 * @param {object} projection The projection definition object
 * @param {object} element The element that is projected from
 * @param {object} [parentElement] for internal recursion purpose
 * @return {object} The projected element
 * @example
 * jsonOdm.util.projectElement({
 *     key1:'value1',
 *     key2:'value2'
 * },{
 *     key1:1,
 *     key12:function(element){return element.key1 + element.key2}
 *     // only field modifying queries are allowed
 *     key2:collection.$query.$branch("key2").$substr(0,3)
 * })
 * // will return {key1:'value1',key12:'value1value2',key2:'val'}
 */
jsonOdm.Util.prototype.projectElement = function(projection,element,parentElement){
    var projectionResult = {},i;
    for(var key in projection){
        <span class="missing-if-branch" title="if path not taken" >I</span>if(!projection.hasOwnProperty(key)) <span class="cstat-no" title="statement not covered" >continue;</span>
        if(projection[key] == 1){
            projectionResult[key] = element[key]; // might be undefined or raises an error
        }else if(typeof projection[key] === 'function'){
            projectionResult[key] = projection[key](parentElement || element);
        }else if(projection[key] instanceof jsonOdm.Query){
            projectionResult[key] = projection[key].$$commandQueue[projection[key].$$commandQueue.length-1](element);
        }else <span class="missing-if-branch" title="else path not taken" >E</span>if(typeof projection[key] === 'object'){
            projectionResult[key] = this.projectElement(projection[key],element[key],parentElement || element);
        }
    }
    return projectionResult;
};
&nbsp;
jsonOdm.util = new jsonOdm.Util();</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Wed Jun 03 2015 22:30:57 GMT+0200 (Mitteleuropäische Sommerzeit)</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
