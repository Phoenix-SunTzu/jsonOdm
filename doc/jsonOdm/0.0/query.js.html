<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>jsonOdm v0.0.1</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <script src="scripts/jquery-2.1.1.min.js"> </script>
    <script src="scripts/page.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href='//fonts.googleapis.com/css?family=Open+Sans:400italic,300,700,600,400' rel='stylesheet' type='text/css'>
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link href="styles/bootstrap.min.css" rel="stylesheet">
    <link href="styles/docs.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  </head>
  <body>
    <header class="header navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="navbar-brand" href="/">
            jsonOdm v0.0.1
          </a>
          <div class="navbar-right">
            <div class="external-links">
              <i class="fa fa-github"></i>
            </div>
          </div>
        </div>
      </div>
    </header>

    <div class="primary-content container-fluid">
      <div class="row-fluid">
          <div class="sidenav col-md-3">
            


<div class="module-list">
  <h3>Modules</h3>
  <ul class="module-listing">
  
    <li data-module-name="jsonOdm" class="collapsed collapsable module-item">
      <span class="collapsed-status">
        <i class="expand fa fa-plus-square-o"></i>
        <i class="collapse fa fa-minus-square-o"></i>
      </span>

      jsonOdm
      <ul class="thing-list">
        

          

  <li class="thing">

    
      <i class="fa fa-cube"></i>
    

    

    

    

    <a href="jsonOdm.Collection.html">Collection</a>
  </li>



          <ul class="thing-list">
            
              

  <li class="thing">

    

    

    

    
      <i class="fa fa-cog"></i>
    

    <a href="jsonOdm.Collection.html#decorate">decorate</a>
  </li>


            
          </ul>

        

          

  <li class="thing">

    
      <i class="fa fa-cube"></i>
    

    

    

    

    <a href="JsonOdm.html">JsonOdm</a>
  </li>



          <ul class="thing-list">
            
          </ul>

        

          

  <li class="thing">

    
      <i class="fa fa-cube"></i>
    

    

    

    

    <a href="jsonOdm.Query.html">Query</a>
  </li>



          <ul class="thing-list">
            
          </ul>

        
      </ul>
    </li>
  
  </ul>
</div>

          </div>

          <div class="col-md-9">
              


    
    <section>
        <article>
            <pre class="prettyprint source"><code>"use strict";

/**
 * The query object that holds the collection to be queried
 * @param {jsonOdm.Collection} collection
 * @constructor
 * @example //This example shows how to query a collection
 * var myCollection = new jsonOdm('myCollection');
 * var $q = myCollection.query();
 * $q.$and(
 *    $q.$or(
 *        $q.$branch('children','id').$eq(1,2),
 *        $q.$branch('children').$isNull()
 *    ),
 *    $q.$each('enabled').$eq(1,true)
 * ).$all();
 */
jsonOdm.Query = function (collection) {
    this.$$commandQueue = [];
    this.$$collection = collection;
    this.$all = function (first) {
        if(this.$$commandQueue.length &lt; 1) return collection;
        var filterCollection = new jsonOdm.Collection();
        for(var i = 0; i &lt; collection.length; i++){
            var validCollection = true;
            for(var j = 0; j &lt; this.$$commandQueue.length; j++){
                if(!(validCollection = validCollection &amp;&amp; this.$$commandQueue[j](collection[i]))){
                    break;
                }
            }
            if(validCollection){
                if(first) return collection[i];
                filterCollection.push(collection[i]);
            }
        }
        return filterCollection;
    };
    this.$first = function () {
        return this.$all(true);
    }

};

/**
 * Test a collection or colection field against one or more values
 * @param {Array} comparables An array of values to test again
 * @param {function} collectionTest the test function to evaluate the values
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$testCollection = function (comparables,collectionTest) {
    var lastCommand = this.$$commandQueue.pop();
    var $testCollection = (function () {
        return function (collection) {
            if(!((lastCommand instanceof jsonOdm.Collection || typeof lastCommand == "function") &amp;&amp; typeof collectionTest == "function")) return false;
            var collectionValue = lastCommand instanceof jsonOdm.Collection?lastCommand:lastCommand(collection);
            return collectionTest(collectionValue,comparables);
        }
    })();
    this.$$commandQueue.push($testCollection);
    return this;
};

/**
 * Test a collection or colection field against one or more values
 * @param {jsonOdm.Query[]} queries A finite number of operators
 * @param {function} operator the test function to evaluate the values
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$binaryOperator = function (queries,operator) {
    var $testCollection = (function (queries,oprator) {
        return function (collection) {
            if(typeof oprator != "function") return false;
            var commandResults = [];
            for(var i = 0; i &lt; queries.length; i++){
                for(var j = 0; j &lt; queries[i].$$commandQueue.length; j++){
                    commandResults.push(queries[i].$$commandQueue[j](collection));
                }
            }
            return operator(commandResults);
        }
    })(queries,operator);
    var subQuery = new jsonOdm.Query(this.$$collection);
    subQuery.$$commandQueue.push($testCollection);
    return subQuery;
};

/** Go down the property tree of the collection
 * @param {...String} node A variable amount of nodes to traverse down the document tree
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$branch = function (node) {
    var $branch = (function(nodes){
        return function(collection){
            return jsonOdm.util.branch(collection,nodes);
        };
    })(arguments);
    var subQuery = new jsonOdm.Query(this.$$collection);
    subQuery.$$commandQueue.push($branch);
    return subQuery;
};

/**
 * Compares the current sub collection value with the comparable
 * like this $eq('1','2','4') so 1 or 2 or 4 are valid fields
 * @param {...*} comparable Values to compare the current field with
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$eq = function (comparable) {
    return this.$testCollection(arguments,function (collectionValue, possibleValues) {
        return Array.prototype.indexOf.call(possibleValues,collectionValue) > -1;
    });
};

/**
 * Compares the current sub collection value with the comparable
 * like this $notEq('1','2','4') so 1 or 2 or 4 are not valid fields
 * @param {...*} comparable Values to compare the current field with
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$notEq = function (comparable) {
    return this.$testCollection(arguments, function (collectionValue, possibleValues) {
        return Array.prototype.indexOf.call(possibleValues,collectionValue) == -1;
    });
};

/**
 * Compares the current sub collection value with the comparable
 * like this $gt('1') field values greater then 1 are valid
 * @param {*} comparable Values to compare the current field with
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$gt = function (comparable) {
    return this.$testCollection(comparable, function (collectionValue, possibleValues) {
        return possibleValues &lt; collectionValue;
    });
};

/**
 * Compares the current sub collection value with the comparable
 * like this $gte('1') field values greater then or equal to 1 are valid
 * @param {*} comparable Values to compare the current field with
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$gte = function (comparable) {
    return this.$testCollection(comparable, function (collectionValue, possibleValues) {
        return possibleValues &lt;= collectionValue;
    });
};

/**
 * Compares the current sub collection value with the comparable
 * like this $lt('1') field values less then 1 are valid
 * @param {*} comparable Values to compare the current field with
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$lt = function (comparable) {
    return this.$testCollection(comparable, function (collectionValue, possibleValues) {
        return possibleValues > collectionValue;
    });
};

/**
 * Compares the current sub collection value with the comparable
 * like this $lte('1') field values less then or equal to 1 are valid
 * @param {*} comparable Values to compare the current field with
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$lte = function (comparable) {
    return this.$testCollection(comparable, function (collectionValue, possibleValues) {
        return possibleValues >= collectionValue;
    });
};

/**
 * Compares the current sub collection value to be null or undefined
 * like this $isNull() field value is null or undefined
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$isNull = function () {
    return this.$testCollection(null, function (collectionValue) {
        return typeof collectionValue == 'undefined' || collectionValue === null;
    });
};

/**
 * Compairs result queries with the booleand and
 * @param {...jsonOdm.Query} queries A finite number of operators
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$and = function (queries) {
    // TODO optimize with generators to only query paths that are needed
    return this.$binaryOperator(arguments, function (queryResults) {
        for(var i = 0; i &lt; queryResults.length; i++){
            if(!queryResults[i]) return false;
        }
        return true;
    });
};

/**
 * Compairs result queries with the boolean or
 * @param {...jsonOdm.Query} queries A finite number of operators
 * @return {jsonOdm.Query}
 */
jsonOdm.Query.prototype.$or = function (queries) {
    // TODO optimize with generators to only query paths that are needed
    return this.$binaryOperator(arguments, function (queryResults) {
        for(var i = 0; i &lt; queryResults.length; i++){
            if(queryResults[i]) return true;
        }
        return false;
    });
};</code></pre>
        </article>
    </section>




          </div>
      </div>

        <br clear="both">

      <footer>
      </footer>
      <script> prettyPrint(); </script>
    </div>
  </body>
</html>
